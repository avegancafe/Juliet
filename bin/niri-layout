#!/bin/bash
# niri-layout - Simple layout launcher for niri compositor
# Spawns windows with titles that match niri window rules for placement
#
# Title convention: niri::<layout>::<app>
# Window rules in niri config handle: output, width, workspace

set -euo pipefail

# Define layouts as functions that spawn windows
layout_coding() {
    niri msg action spawn -- ghostty --title="niri::coding::btop" -e btop
    niri msg action spawn -- ghostty --title="niri::coding::term"
}

layout_gaming() {
    niri msg action spawn -- discord
    niri msg action spawn -- firefox
    niri msg action spawn -- ghostty --title="niri::gaming::term"
    niri msg action spawn -- steam
}

layout_work() {
    niri msg action spawn -- slack
    niri msg action spawn -- spotify
    niri msg action spawn -- ghostty --title="niri::work::term"
    niri msg action spawn -- firefox
}

# List available layouts
list_layouts() {
    echo "coding"
    echo "gaming"
    echo "work"
}

# Print usage
usage() {
    echo "Usage: niri-layout [--list | <layout-name>]"
    echo ""
    echo "Layouts:"
    list_layouts | sed 's/^/  /'
    exit 1
}

# Main
case "${1:-}" in
    --list)
        list_layouts
        ;;
    --help|-h|"")
        usage
        ;;
    coding)
        echo "Applying layout: coding"
        layout_coding
        echo "Done."
        ;;
    gaming)
        echo "Applying layout: gaming"
        layout_gaming
        echo "Done."
        ;;
    work)
        echo "Applying layout: work"
        layout_work
        echo "Done."
        ;;
    *)
        echo "Error: Unknown layout '$1'"
        echo ""
        usage
        ;;
esac
